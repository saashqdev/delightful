# 知识检索节点

## 什么是知识检索节点？

知识检索节点是一个强大的语义搜索工具，能够根据用户输入的关键词，在指定的天书知识库中查找相关内容。该节点利用向量相似度匹配技术，帮助您快速定位需要的知识片段，实现高效的知识检索与应用。

**图片说明：**

知识检索节点界面主要包含知识库选择区、检索参数设置区和输出配置区。中间可以选择知识库来源，并设置相似度阈值、最大条数等参数。
![知识检索节点](https://cdn.letsmagic.cn/static/img/Knowledge-retrieval-node.png)


## 为什么需要知识检索节点？
在构建智能应用过程中，知识检索节点解决了以下关键问题：
- **专业知识获取**：让AI能够获取并使用企业内部的专业资料、文档或知识
- **提高答案准确性**：通过检索相关信息，使AI回答更加准确、专业，减少"想象"或过时答案
- **知识时效性**：可以获取最新更新的知识内容，解决大模型知识截止日期的限制
- **个性化内容**：根据用户的具体需求，提供有针对性的专业知识回答
- **减少训练成本**：无需为每个新知识重新训练模型，只需更新知识库即可
## 适用场景
### 1. 企业内部知识问答系统
构建能够回答公司政策、流程、产品信息等问题的内部助手，帮助新员工快速了解公司信息或协助老员工查询最新规定。
### 2. 专业客服机器人
创建能够精准回答产品问题、故障排除、使用指南等专业问题的客服机器人，提高客户服务质量和效率。
### 3. 文档智能助手
设计一个可以理解并回答关于特定文档内容的智能助手，如产品手册解读、合同条款解释、研究报告分析等。
### 4. 学习辅导系统
构建能够基于教育资料回答学习问题、提供知识解释的学习辅导系统，帮助学生更好地理解复杂概念。
## 节点参数说明
### 基本参数
|参数名称|说明|是否必填|默认值|
|---|---|---|---|
|知识库|选择要检索的知识库，可选择一个或多个|是|无|
|搜索关键词|检索的关键词或问题，用于查找相关内容|是|无|
|最小匹配度|设置知识匹配的最低相似度要求，范围0~1|-|0.4|
|最大召回数|返回的最大结果条数|-|5|

### 高级参数
### 输出内容
|输出字段|说明|
|---|---|
|片段列表（fragments）|检索到的知识片段列表，包含内容和相似度信息|
|召回的结果集（similarities）|各片段的相似度分数列表|
|total_count|检索到的总知识片段数量|

## 使用说明
### 基本配置步骤
1. **选择知识库**：
    1. 点击知识库下拉框，选择一个或多个要检索的知识库
    2. 可以选择公共知识库或自己创建的专用知识库
2. **设置搜索关键词**：
    1. 输入检索的关键词或问题
    2. 可直接输入固定文本，如"公司的年休假政策是什么？"
    3. 也可使用变量引用动态内容，如`user_question}}`引用用户的实际提问
3. **调整最小匹配度**：
    1. 拖动滑块设置相似度阈值（0.01至0.99之间）
    2. 值越高要求匹配越精确，但可能漏掉相关内容
    3. 值越低包含更多相关内容，但可能出现不太相关的结果
4. **设置最大召回数**：
    1. 根据需要设置返回的最大结果条数
    2. 建议为3-5条，既能提供足够信息又不会过多
### 进阶技巧
#### 优化检索效果
1. **提高检索精确性**：
    1. 使用明确、具体的问题而非宽泛的关键词
    2. 调高相似度阈值（如0.7以上）获取更精确的匹配
    3. 选择专门针对特定主题的知识库而非综合知识库
2. **增加检索覆盖面**：
    1. 使用多个相关知识库同时检索
    2. 适当降低相似度阈值（如0.5左右）
    3. 增加返回的最大条数
#### 与其他节点协同
1. **搭配大模型调用节点**：
    1. 将检索结果作为上下文提供给大模型
    2. 让大模型基于检索到的知识生成更准确的回答
2. **结合条件分支节点**：
    1. 检查是否找到相关知识（fragments长度>0）
    2. 如有结果，则提供专业回答
    3. 如无结果，则转向通用回答或人工服务
3. **配合变量保存节点**：
    1. 保存检索结果供多个后续节点使用
    2. 避免重复检索相同内容，提高效率
## 注意事项
### 知识库质量
知识检索的效果很大程度上取决于知识库的质量：
- 确保知识库内容准确、完整、最新
- 定期更新知识库，删除过时信息
- 适当对知识内容进行分类和标记，提高检索精度
### 检索效率
检索大型知识库可能影响性能：
- 尽量选择与问题最相关的知识库，而非检索所有知识库
- 合理设置最大条数，避免返回过多不必要的结果
- 考虑将常见问题的检索结果缓存起来，提高响应速度
### 隐私安全
知识库可能包含敏感信息：
- 确保知识库的访问权限设置正确
- 避免在公共场景暴露敏感知识内容
- 对检索结果进行必要的内容过滤
## 常见问题
### 问题1：检索不到相关内容怎么办？
**解决方案**：
- 尝试降低相似度阈值，如从0.7降至0.5
- 重新组织检索问题，使用更多关键词或更简洁的表述
- 检查知识库是否包含相关内容，必要时更新知识库
- 考虑选择更多相关知识库进行检索
### 问题2：检索结果包含过多不相关内容？
**解决方案**：
- 提高相似度阈值，如从0.5提高到0.7或更高
- 使用更精确的问题描述
- 缩小知识库范围，选择更专注于特定主题的知识库
- 减少返回的最大条数
### 问题3：如何处理多样化的用户问题？
**解决方案**：
- 使用意图识别节点先分析用户问题类型
- 根据不同问题类型选择不同的知识库
- 配置不同的相似度阈值和最大条数
- 结合大模型对检索结果进行整合和优化
## 最佳实践
### 常见搭配节点
|节点类型|搭配原因|
|---|---|
|大模型调用节点|将检索结果作为上下文提供给大模型，生成基于知识的回答|
|条件分支节点|根据检索结果决定后续处理流程|
|消息回复节点|将处理后的知识内容回复给用户|
|文本切割节点|处理过长的检索结果，确保适合后续处理|
|变量保存节点|保存检索结果供多个节点使用|