<?php declare(strict_types=1); /** * Copyright (c) Be Delightful , Distributed under the MIT software license */ namespace Delightful\BeDelightful\Interfaces\BeAgent\DTO\Response; /** * ParticipateProjectconditiontargetDTO (ExtensionselfProjectItemDTO, addParticipateProjectspecial have field).*/ class ParticipatedProjectItemDTO extends ProjectItemDTO { public function __construct( // InheritanceparentClassAllfield string $id, string $workspaceId, string $projectName, string $projectDescription, string $workDir, string $currentTopicId, string $currentTopicStatus, string $projectStatus, ?string $projectMode, ?string $workspaceName, ?string $createdAt, ?string $updatedAt, ?string $tag, ?string $userId, ?bool $isCollaborationEnabled, ?string $defaultJoinPermission, // ParticipateProjectspecial have field public readonly string $userRole = 'owner', // UserinProjectinRole：owner-ProjectAll person ，collaborator-Collaborator public readonly bool $isPinned = false, public readonly string $organizationCode = '', ) { parent::__construct( $id, $workspaceId, $projectName, $projectDescription, $workDir, $currentTopicId, $currentTopicStatus, $projectStatus, $projectMode, $workspaceName, $createdAt, $updatedAt, $tag, $userId, $isCollaborationEnabled, $defaultJoinPermission ); } /** * Create DTO from array data. */ public static function fromArray(array $data, ?string $workspaceName = Null, bool $hasProjectMember = false): self { $isCollaborator = (bool) ($data['is_collaborator'] ?? false); // Tag logic: JudgeProjectwhether be Share (whether have Collaborator) $tag = $hasProjectMember ? 'collaboration' : ''; // Role logic: CurrentuserinProject in Role $userRole = $data['user_role'] ?? ''; return new self( id: (string) $data['id'], workspaceId: (string) $data['workspace_id'], projectName: $data['project_name'] ?? '', projectDescription: $data['project_description'] ?? '', workDir: $data['work_dir'] ?? '', currentTopicId: (string) ($data['current_topic_id'] ?? ''), currentTopicStatus: self::convertStatus($data['current_topic_status'] ?? ''), projectStatus: self::convertStatus($data['project_status'] ?? ''), projectMode: $data['project_mode'] ?? 'default', workspaceName: $workspaceName, createdAt: $data['created_at'] ?? Null, updatedAt: $data['updated_at'] ?? Null, tag: $tag, userId: $data['user_id'] ?? '', userRole: $userRole, isPinned: (bool) ($data['is_pinned'] ?? false), organizationCode: $data['organization_code'] ?? '', isCollaborationEnabled: (bool) ($data['is_collaboration_enabled'] ?? false), defaultJoinPermission: $data['default_join_permission'] ?? '', ); } /** * Convert toArray (containingParticipateProjectspecial have field).*/ public function toArray(): array { return array_merge(parent::toArray(), [ 'user_role' => $this->userRole, 'is_pinned' => $this->isPinned, 'organization_code' => $this->organizationCode, ]); } /** * Convert status value to string. */ private static function convertStatus(mixed $status): string { return (string) $status; } } 
