<?php declare(strict_types=1); /** * Copyright (c) Be Delightful , Distributed under the MIT software license */ namespace Delightful\BeDelightful\Interfaces\BeAgent\Facade; use App\Infrastructure\Util\Context\RequestContext; use Delightful\ApiResponse\Annotation\ApiResponse; use Delightful\BeDelightful\Application\BeAgent\Service\FileEditingAppService; use Hyperf\HttpServer\Contract\RequestInterface; #[ApiResponse('low_code')] class FileEditingApi extends AbstractApi { public function __construct( private readonly FileEditingAppService $fileEditingAppService, protected RequestInterface $request, ) { parent::__construct($request); } /** * JoinEdit.*/ public function joinEditing(RequestContext $requestContext, string $fileId): array { // set user authorization information $requestContext->setUserAuthorization($this->getAuthorization()); // callApplicationService $this->fileEditingAppService->joinEditing($requestContext, (int) $fileId); return []; } /** * leaveEdit.*/ public function leaveEditing(RequestContext $requestContext, string $fileId): array { // set user authorization information $requestContext->setUserAuthorization($this->getAuthorization()); // callApplicationService $this->fileEditingAppService->leaveEditing($requestContext, (int) $fileId); return []; } /** * getEdituserQuantity.*/ public function getEditingUsers(RequestContext $requestContext, string $fileId): array { // set user authorization information $requestContext->setUserAuthorization($this->getAuthorization()); // callApplicationService $userCount = $this->fileEditingAppService->getEditingUsers($requestContext, (int) $fileId); return [ 'editing_user_count' => $userCount, ]; } } 