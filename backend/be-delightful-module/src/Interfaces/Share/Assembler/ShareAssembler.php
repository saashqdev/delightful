<?php declare(strict_types=1); /** * Copyright (c) Be Delightful , Distributed under the MIT software license */ namespace Delightful\BeDelightful\Interfaces\Share\Assembler; use Delightful\BeDelightful\Domain\Share\Constant\ResourceType; use Delightful\BeDelightful\Domain\Share\Entity\ResourceShareEntity; use Delightful\BeDelightful\Domain\Share\Service\ResourceShareDomainService; use Delightful\BeDelightful\Interfaces\Share\DTO\Response\ShareItemDTO; use Delightful\BeDelightful\Interfaces\Share\DTO\Response\ShareItemWithPasswordDTO; /** * shareassemblydevice * ResponsibleConvertDomainEntityConvert toDifferentTypeDTO.*/ class ShareAssembler { public function __construct( private ResourceShareDomainService $shareDomainService ) { } /** * ConvertshareEntityConvert toBaseDTO. * * @param ResourceShareEntity $share shareEntity * @return ShareItemDTO BaseshareDTO*/ public function toDto(ResourceShareEntity $share): ShareItemDTO { $dto = new ShareItemDTO(); $dto->id = (string) $share->getId(); $dto->resourceId = $share->getResourceId(); $dto->resourceType = $share->getResourceType(); $dto->resourceTypeName = ResourceType::tryFrom($share->getResourceType())->name ?? ''; $dto->shareCode = $share->getShareCode(); $dto->hasPassword = ! empty($share->getPassword()); $dto->shareType = $share->getShareType(); return $dto; } /** * ConvertshareEntityConvert towithpasswordDTO. * * @param ResourceShareEntity $share shareEntity * @return ShareItemWithPasswordDTO withpasswordshareDTO*/ public function toDtoWithPassword(ResourceShareEntity $share): ShareItemWithPasswordDTO { // First create baseDTO $baseDto = $this->toDto($share); // getDecrypt after password $password = ''; if ($baseDto->hasPassword) { $password = $this->shareDomainService->getDecryptedPassword($share); } // Create withpasswordDTO return ShareItemWithPasswordDTO::fromBaseDto($baseDto, $password); } } 