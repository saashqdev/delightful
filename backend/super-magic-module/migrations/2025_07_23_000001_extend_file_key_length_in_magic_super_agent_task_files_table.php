<?php declare(strict_types=1); /** * Copyright (c) Be Delightful , Distributed under the MIT software license */ use Hyperf\Database\Migrations\Migration; use Hyperf\Database\Schema\Blueprint; use Hyperf\Database\Schema\Schema; return new class extends Migration { /** * Run the migrations. */ public function up(): void { if (! Schema::hasTable('magic_super_agent_task_files')) { return; } Schema::table('magic_super_agent_task_files', static function (Blueprint $table) { // Extension file_key fieldLengthfrom varchar(255) to varchar(500) // 500Character Ã— 4Byte = 2000Byte, farsmallindexKeyLengthLimit3072Byte $table->string('file_key', 500)->default('')->change()->comment('file storage path (Extensionlength)'); }); } /** * Reverse the migrations. */ public function down(): void { if (! Schema::hasTable('magic_super_agent_task_files')) { return; } Schema::table('magic_super_agent_task_files', static function (Blueprint $table) { // Rollback: Convert file_key fieldLengthfrom varchar(500) Recoverto varchar(255) $table->string('file_key', 255)->default('')->change()->comment('file storage path'); }); } }; 