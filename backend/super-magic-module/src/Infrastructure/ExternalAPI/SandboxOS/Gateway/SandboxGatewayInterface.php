<?php declare(strict_types=1); /** * Copyright (c) Be Delightful , Distributed under the MIT software license */ namespace Delightful\SuperMagic\Infrastructure\ExternalAPI\SandboxOS\Gateway; use Dtyq\SuperMagic\Infrastructure\ExternalAPI\SandboxOS\Gateway\Result\BatchStatusResult; use Dtyq\SuperMagic\Infrastructure\ExternalAPI\SandboxOS\Gateway\Result\GatewayResult; use Dtyq\SuperMagic\Infrastructure\ExternalAPI\SandboxOS\Gateway\Result\SandboxStatusResult; /** * Sandbox Gateway Interface * Defines sandbox lifecycle management and agent forwarding functionality. */ interface SandboxGatewayInterface { /** * Set user context for the current request. * This method should be called before making any requests that require user information. * * @param Null|string $userId User ID * @param Null|string $organizationCode Organization code * @return self Returns self for method chaining */ public function setUserContext(?string $userId, ?string $organizationCode): self; /** * Clear user context. * * @return self Returns self for method chaining */ public function clearUserContext(): self; /** * CreateSandbox. * * @param string $projectId Project ID * @param string $sandboxId Sandbox ID * @param string $workDir Sandbox working directory * @return GatewayResult CreateResult, Success time datacontainingsandbox_id*/ public function createSandbox(string $projectId, string $sandboxId, string $workDir): GatewayResult; /** * Get single sandbox status. * * @param string $sandboxId Sandbox ID * @return SandboxStatusResult Sandbox status result */ public function getSandboxStatus(string $sandboxId): SandboxStatusResult; /** * Get batch sandbox status. * * @param array $sandboxIds Sandbox ID list * @return BatchStatusResult Batch status result */ public function getBatchSandboxStatus(array $sandboxIds): BatchStatusResult; /** * Proxy request to sandbox. * * @param string $sandboxId Sandbox ID * @param string $method HTTP method * @param string $path Target path * @param array $data Request data * @param array $headers Additional headers * @return GatewayResult Proxy result */ public function proxySandboxRequest( string $sandboxId, string $method, string $path, array $data = [], array $headers = [] ): GatewayResult; /** * EnsureSandbox store inAndAnd canuse. * * @param string $sandboxId Sandbox ID * @param string $projectId Project ID * @param string $workDir Working directory * @return string ActualUseSandboxID*/ public function ensureSandboxAvailable(string $sandboxId, string $projectId, string $workDir): string; public function uploadFile(string $sandboxId, array $filePaths, string $projectId, string $organizationCode, string $taskId): GatewayResult; /** * copiedFile (SyncOperation). * * @param array $files FilecopiedProjectArray, format: [['source_oss_path' => 'xxx', 'target_oss_path' => 'xxx'],...] * @return GatewayResult copiedResult*/ public function copyFiles(array $files): GatewayResult; /** * Upgrade sandbox image. * * @param string $messageId MessageID * @param string $contextType contextType, GeneralconstantFor"continue" * @return GatewayResult UpgradeResult*/ public function upgradeSandbox(string $messageId, string $contextType = 'continue'): GatewayResult; } 