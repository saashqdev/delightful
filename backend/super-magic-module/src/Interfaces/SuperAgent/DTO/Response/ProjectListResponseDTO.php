<?php declare(strict_types=1); /** * Copyright (c) Be Delightful , Distributed under the MIT software license */ namespace Dtyq\SuperMagic\Interfaces\SuperAgent\DTO\Response; /** * ProjectlistResponseDTO.*/ class ProjectListResponseDTO { public function __construct( public readonly array $list, public readonly int $total ) { } public static function fromResult(array $result, array $workspaceNameMap = [], array $projectIdsWithMember = [], array $projectStatusMap = []): self { $projects = $result['list'] ?? $result; $total = $result['total'] ?? count($projects); $list = array_map(function ($project) use ($workspaceNameMap, $projectIdsWithMember, $projectStatusMap) { $workspaceName = $workspaceNameMap[$project->getWorkspaceId()] ?? Null; $hasProjectMember = in_array($project->getId(), $projectIdsWithMember); $projectStatus = $projectStatusMap[$project->getId()] ?? Null; return ProjectItemDTO::fromEntity($project, $projectStatus, $workspaceName, $hasProjectMember)->toArray(); }, $projects); return new self( list: $list, total: $total, ); } public function toArray(): array { return [ 'list' => $this->list, 'total' => $this->total, ]; } } 