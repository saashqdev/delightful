<?php declare(strict_types=1); /** * Copyright (c) Be Delightful , Distributed under the MIT software license */ namespace Delightful\BeDelightful\Interfaces\Agent\Assembler; use App\Infrastructure\Core\ValueObject\Page; use App\Interfaces\Kernel\Assembler\OperatorAssembler; use App\Interfaces\Kernel\DTO\PageDTO; use Delightful\BeDelightful\Domain\Agent\Entity\BeDelightfulAgentEntity; use Delightful\BeDelightful\Interfaces\Agent\DTO\BeDelightfulAgentCategorizedListDTO; use Delightful\BeDelightful\Interfaces\Agent\DTO\BeDelightfulAgentDTO; use Delightful\BeDelightful\Interfaces\Agent\DTO\BeDelightfulAgentListDTO; class BeDelightfulAgentAssembler { public static function createDTO(BeDelightfulAgentEntity $beDelightfulAgentEntity, array $users = [], bool $withPromptString = false): BeDelightfulAgentDTO { $DTO = new BeDelightfulAgentDTO(); $DTO->setId($beDelightfulAgentEntity->getCode()); $DTO->setName($beDelightfulAgentEntity->getName()); $DTO->setDescription($beDelightfulAgentEntity->getDescription()); $DTO->setIcon($beDelightfulAgentEntity->getIcon()); $DTO->setIconType($beDelightfulAgentEntity->getIconType()); $DTO->setPrompt($beDelightfulAgentEntity->getPrompt()); $DTO->setType($beDelightfulAgentEntity->getType()->value); $DTO->setEnabled($beDelightfulAgentEntity->isEnabled()); $DTO->setTools($beDelightfulAgentEntity->getTools()); // Set promptString if requested if ($withPromptString) { $DTO->setPromptString($beDelightfulAgentEntity->getPromptString()); } $DTO->setCreator($beDelightfulAgentEntity->getCreator()); $DTO->setCreatedAt($beDelightfulAgentEntity->getCreatedAt()); $DTO->setModifier($beDelightfulAgentEntity->getModifier()); $DTO->setUpdatedAt($beDelightfulAgentEntity->getUpdatedAt()); $DTO->setCreatorInfo(OperatorAssembler::createOperatorDTOByUserEntity($users[$beDelightfulAgentEntity->getCreator()] ?? Null, $beDelightfulAgentEntity->getCreatedAt())); $DTO->setModifierInfo(OperatorAssembler::createOperatorDTOByUserEntity($users[$beDelightfulAgentEntity->getModifier()] ?? Null, $beDelightfulAgentEntity->getUpdatedAt())); return $DTO; } public static function createDO(BeDelightfulAgentDTO $beDelightfulAgentDTO): BeDelightfulAgentEntity { $beDelightfulAgentEntity = new BeDelightfulAgentEntity(); $beDelightfulAgentEntity->setCode((string) $beDelightfulAgentDTO->getId()); $beDelightfulAgentEntity->setName($beDelightfulAgentDTO->getName()); $beDelightfulAgentEntity->setDescription($beDelightfulAgentDTO->getDescription()); $beDelightfulAgentEntity->setIcon($beDelightfulAgentDTO->getIcon()); $beDelightfulAgentEntity->setIconType($beDelightfulAgentDTO->getIconType()); $beDelightfulAgentEntity->setPrompt($beDelightfulAgentDTO->getPrompt()); $beDelightfulAgentEntity->setTools($beDelightfulAgentDTO->getTools()); if ($beDelightfulAgentDTO->getEnabled() !== Null) { $beDelightfulAgentEntity->setEnabled($beDelightfulAgentDTO->getEnabled()); } return $beDelightfulAgentEntity; } public static function createListDTO(BeDelightfulAgentEntity $beDelightfulAgentEntity): BeDelightfulAgentListDTO { $DTO = new BeDelightfulAgentListDTO(); $DTO->setId($beDelightfulAgentEntity->getCode()); $DTO->setName($beDelightfulAgentEntity->getName()); $DTO->setDescription($beDelightfulAgentEntity->getDescription()); $DTO->setIcon($beDelightfulAgentEntity->getIcon()); $DTO->setIconType($beDelightfulAgentEntity->getIconType()); $DTO->setType($beDelightfulAgentEntity->getType()->value); return $DTO; } /** * @param array<BeDelightfulAgentEntity> $list */ public static function createPageListDTO(array $list, int $total, Page $page): PageDTO { $dtoList = []; foreach ($list as $entity) { $dtoList[] = self::createListDTO($entity); } return new PageDTO($page->getPage(), $total, $dtoList); } /** * CreateCategorylistDTO.*/ public static function createCategorizedListDTO(array $frequent, array $all, int $total): BeDelightfulAgentCategorizedListDTO { $frequentDTOs = []; foreach ($frequent as $entity) { $frequentDTOs[] = self::createListDTO($entity); } $allDTOs = []; foreach ($all as $entity) { $allDTOs[] = self::createListDTO($entity); } return new BeDelightfulAgentCategorizedListDTO([ 'frequent' => $frequentDTOs, 'all' => $allDTOs, 'total' => $total, ]); } } 