<?php declare(strict_types=1); /** * Copyright (c) Be Delightful , Distributed under the MIT software license */ namespace Delightful\SuperMagic\Interfaces\SuperAgent\DTO\Response; use Dtyq\SuperMagic\Domain\SuperAgent\Entity\ProjectEntity; /** * CollaborationProjectconditiontargetDTO (ExtensionselfProjectItemDTO).*/ class CollaborationProjectItemDTO extends ProjectItemDTO { public function __construct( // InheritanceparentClassAllfield string $id, string $workspaceId, string $projectName, string $projectDescription, string $workDir, string $currentTopicId, string $currentTopicStatus, string $projectStatus, ?string $projectMode, ?string $workspaceName, ?string $createdAt, ?string $updatedAt, ?string $tag, ?string $userId, ?bool $isCollaborationEnabled, ?string $defaultJoinPermission, // Add newfield public readonly ?CreatorInfoDTO $creator, public readonly array $members, public readonly int $memberCount, public readonly bool $isPinned = false, public readonly ?string $lastActiveAt = Null, public readonly bool $isBindWorkspace = false, public readonly string $bindWorkspaceId = '', public readonly ?string $userRole = Null, ) { parent::__construct( $id, $workspaceId, $projectName, $projectDescription, $workDir, $currentTopicId, $currentTopicStatus, $projectStatus, $projectMode, $workspaceName, $createdAt, $updatedAt, $tag, $userId, $isCollaborationEnabled, $defaultJoinPermission, ); } /** * fromProjectEntityAndExtensioninformationCreateDTO.*/ public static function fromEntityWithExtendedInfo( ProjectEntity $project, ?CreatorInfoDTO $creator = Null, array $members = [], int $memberCount = 0, ?string $projectStatus = Null, ?string $workspaceName = Null, bool $isPinned = false, ?string $lastActiveAt = Null, bool $isBindWorkspace = false, string $bindWorkspaceId = '', ?string $userRole = Null ): self { return new self( id: (string) $project->getId(), workspaceId: (string) $project->getWorkspaceId(), projectName: $project->getProjectName(), projectDescription: $project->getProjectDescription(), workDir: $project->getWorkDir(), currentTopicId: (string) $project->getCurrentTopicId(), currentTopicStatus: $project->getCurrentTopicStatus(), projectStatus: $projectStatus ?? $project->getCurrentTopicStatus(), projectMode: $project->getProjectMode(), workspaceName: $workspaceName, createdAt: $project->getCreatedAt(), updatedAt: $project->getUpdatedAt(), creator: $creator, members: $members, memberCount: $memberCount, isPinned: $isPinned, lastActiveAt: $lastActiveAt, isBindWorkspace: $isBindWorkspace, bindWorkspaceId: $bindWorkspaceId, userRole: $userRole, tag: 'collaboration', userId: $project->getUserId(), isCollaborationEnabled: $project->getIsCollaborationEnabled(), defaultJoinPermission: $project->getDefaultJoinPermission()->value, ); } /** * Convert toArray (containingExtensionfield).*/ public function toArray(): array { return array_merge(parent::toArray(), [ 'tag' => $this->tag, 'creator' => $this->creator?->toArray(), 'members' => array_map(fn ($member) => $member->toArray(), $this->members), 'member_count' => $this->memberCount, 'is_pinned' => $this->isPinned, 'last_active_at' => $this->lastActiveAt, 'is_bind_workspace' => $this->isBindWorkspace, 'bind_workspace_id' => $this->bindWorkspaceId, 'user_role' => $this->userRole, ]); } } 