<?php declare(strict_types=1); /** * Copyright (c) Be Delightful , Distributed under the software license */ namespace Dtyq\SuperMagic\Infrastructure\Utils; /** * passwordHashToolClass.*/ class PasswordHasher { protected string $hashAlgo = PASSWORD_BCRYPT; /** * passwordHashoption.*/ protected array $hashOptions = [ 'cost' => 10, ]; /** * Pairpassword enter RowHashProcess/Handle. * * @param string $password Originalpassword * @return string Hash after password*/ public function hash(string $password): string { return password_hash($password, $this->hashAlgo, $this->hashOptions); } /** * Validatepasswordwhethercorrect. * * @param string $password Originalpassword * @param string $hash Hash after password * @return bool whetherValidatethrough*/ public function verify(string $password, string $hash): bool { return password_verify($password, $hash); } /** * CheckpasswordHashwhetherNeed re Hash. * * @param string $hash Hash after password * @return bool whetherNeed re Hash*/ public function needsRehash(string $hash): bool { return password_needs_rehash($hash, $this->hashAlgo, $this->hashOptions); } } 