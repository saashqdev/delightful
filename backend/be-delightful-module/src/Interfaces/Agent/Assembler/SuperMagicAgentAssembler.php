<?php declare(strict_types=1); /** * Copyright (c) Be Delightful , Distributed under the MIT software license */ namespace Delightful\SuperDelightful\Interfaces\Agent\Assembler; use App\Infrastructure\Core\ValueObject\Page; use App\Interfaces\Kernel\Assembler\OperatorAssembler; use App\Interfaces\Kernel\DTO\PageDTO; use Delightful\SuperDelightful\Domain\Agent\Entity\SuperDelightfulAgentEntity; use Delightful\SuperDelightful\Interfaces\Agent\DTO\SuperDelightfulAgentCategorizedListDTO; use Delightful\SuperDelightful\Interfaces\Agent\DTO\SuperDelightfulAgentDTO; use Delightful\SuperDelightful\Interfaces\Agent\DTO\SuperDelightfulAgentListDTO; class SuperDelightfulAgentAssembler { public static function createDTO(SuperDelightfulAgentEntity $superDelightfulAgentEntity, array $users = [], bool $withPromptString = false): SuperDelightfulAgentDTO { $DTO = new SuperDelightfulAgentDTO(); $DTO->setId($superDelightfulAgentEntity->getCode()); $DTO->setName($superDelightfulAgentEntity->getName()); $DTO->setDescription($superDelightfulAgentEntity->getDescription()); $DTO->setIcon($superDelightfulAgentEntity->getIcon()); $DTO->setIconType($superDelightfulAgentEntity->getIconType()); $DTO->setPrompt($superDelightfulAgentEntity->getPrompt()); $DTO->setType($superDelightfulAgentEntity->getType()->value); $DTO->setEnabled($superDelightfulAgentEntity->isEnabled()); $DTO->setTools($superDelightfulAgentEntity->getTools()); // Set promptString if requested if ($withPromptString) { $DTO->setPromptString($superDelightfulAgentEntity->getPromptString()); } $DTO->setCreator($superDelightfulAgentEntity->getCreator()); $DTO->setCreatedAt($superDelightfulAgentEntity->getCreatedAt()); $DTO->setModifier($superDelightfulAgentEntity->getModifier()); $DTO->setUpdatedAt($superDelightfulAgentEntity->getUpdatedAt()); $DTO->setCreatorInfo(OperatorAssembler::createOperatorDTOByUserEntity($users[$superDelightfulAgentEntity->getCreator()] ?? Null, $superDelightfulAgentEntity->getCreatedAt())); $DTO->setModifierInfo(OperatorAssembler::createOperatorDTOByUserEntity($users[$superDelightfulAgentEntity->getModifier()] ?? Null, $superDelightfulAgentEntity->getUpdatedAt())); return $DTO; } public static function createDO(SuperDelightfulAgentDTO $superDelightfulAgentDTO): SuperDelightfulAgentEntity { $superDelightfulAgentEntity = new SuperDelightfulAgentEntity(); $superDelightfulAgentEntity->setCode((string) $superDelightfulAgentDTO->getId()); $superDelightfulAgentEntity->setName($superDelightfulAgentDTO->getName()); $superDelightfulAgentEntity->setDescription($superDelightfulAgentDTO->getDescription()); $superDelightfulAgentEntity->setIcon($superDelightfulAgentDTO->getIcon()); $superDelightfulAgentEntity->setIconType($superDelightfulAgentDTO->getIconType()); $superDelightfulAgentEntity->setPrompt($superDelightfulAgentDTO->getPrompt()); $superDelightfulAgentEntity->setTools($superDelightfulAgentDTO->getTools()); if ($superDelightfulAgentDTO->getEnabled() !== Null) { $superDelightfulAgentEntity->setEnabled($superDelightfulAgentDTO->getEnabled()); } return $superDelightfulAgentEntity; } public static function createListDTO(SuperDelightfulAgentEntity $superDelightfulAgentEntity): SuperDelightfulAgentListDTO { $DTO = new SuperDelightfulAgentListDTO(); $DTO->setId($superDelightfulAgentEntity->getCode()); $DTO->setName($superDelightfulAgentEntity->getName()); $DTO->setDescription($superDelightfulAgentEntity->getDescription()); $DTO->setIcon($superDelightfulAgentEntity->getIcon()); $DTO->setIconType($superDelightfulAgentEntity->getIconType()); $DTO->setType($superDelightfulAgentEntity->getType()->value); return $DTO; } /** * @param array<SuperDelightfulAgentEntity> $list */ public static function createPageListDTO(array $list, int $total, Page $page): PageDTO { $dtoList = []; foreach ($list as $entity) { $dtoList[] = self::createListDTO($entity); } return new PageDTO($page->getPage(), $total, $dtoList); } /** * CreateCategorylistDTO.*/ public static function createCategorizedListDTO(array $frequent, array $all, int $total): SuperDelightfulAgentCategorizedListDTO { $frequentDTOs = []; foreach ($frequent as $entity) { $frequentDTOs[] = self::createListDTO($entity); } $allDTOs = []; foreach ($all as $entity) { $allDTOs[] = self::createListDTO($entity); } return new SuperDelightfulAgentCategorizedListDTO([ 'frequent' => $frequentDTOs, 'all' => $allDTOs, 'total' => $total, ]); } } 