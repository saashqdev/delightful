<?php declare(strict_types=1); /** * Copyright (c) Be Delightful , Distributed under the MIT software license */ namespace Delightful\SuperMagic\Infrastructure\Utils; /** * ReversiblepasswordEncryptDecryptTool.*/ class PasswordCrypt { /** * Encryptmethod. * * @param string $password Originalpassword * @return string Encrypt after password*/ public static function encrypt(string $password): string { if (empty($password)) { return ''; } // Use openssl Encrypt $method = 'AES-256-CBC'; $key = self::getEncryptKey(); $iv = substr(hash('sha256', self::getEncryptIv()), 0, 16); $encrypted = openssl_encrypt($password, $method, $key, 0, $iv); return base64_encode($encrypted); } /** * Decryptmethod. * * @param string $encryptedPassword Encrypt after password * @return string Decrypt after Originalpassword*/ public static function decrypt(string $encryptedPassword): string { if (empty($encryptedPassword)) { return ''; } // Use openssl Decrypt $method = 'AES-256-CBC'; $key = self::getEncryptKey(); $iv = substr(hash('sha256', self::getEncryptIv()), 0, 16); $encrypted = base64_decode($encryptedPassword); $result = openssl_decrypt($encrypted, $method, $key, 0, $iv); return $result === false ? '' : $result; } /** * getEncryptkey. * * @return string Encryptkey*/ private static function getEncryptKey(): string { return config('super-magic.share.encrypt_key'); } /** * getEncryptVector. * * @return string EncryptVector*/ private static function getEncryptIv(): string { return config('super-magic.share.encrypt_iv'); } } 