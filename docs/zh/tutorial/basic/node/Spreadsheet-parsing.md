# 电子表格解析节点
## 节点介绍
电子表格解析节点是一个专门用于提取和解析Excel表格文件内容的工具。与普通的文档解析节点不同，电子表格解析节点能够识别表格的结构，保留工作表、行、列等关键信息，使得数据在工作流中可以更加**结构化（区别于文档解析）**地使用。无需编程知识，只要简单配置，即可轻松获取Excel表格中的所有数据，并按照表格原有的**结构**进行保存和传递。

**图片说明：**

电子表格解析节点界面包含输入和输出两个主要部分。输入部分可以设置文件来源（文件列表、单个文件等），输出部分则是解析后的表格数据结构，包含文件信息和表格内容。
![电子表格解析节点](https://cdn.letsmagic.cn/static/img/Spreadsheet-parsing.png)

## 为什么需要电子表格解析节点
在日常工作中，Excel文件是存储和传递数据的常用格式。通过电子表格解析节点，您可以：
- **内容自动获取**：自动读取Excel文件中的数据，省去手动复制粘贴的繁琐过程
- **批处理**：批量处理多个电子表格文件，提高工作效率
- **结构化分析**：将表格数据转换为结构化格式，便于后续节点进行智能分析和处理
- **智能处理**：利用大模型对表格数据进行理解和操作，实现智能数据处理
## 适用场景
电子表格解析节点适用于以下场景：
### **场景一：数据分析自动化**：
自动读取员工考勤表、销售报表等Excel文件，进行数据分析并生成摘要报告
### **场景二：数据导入处理**：
导入产品目录、客户资料等电子表格，并将数据存入系统或知识库
### **场景三：智能表单处理**：
解析用户上传的Excel表单，进行数据验证、清洗和转换
## 节点参数说明
### 输入参数
|参数名称|说明|是否必填|默认值|
|---|---|---|---|
|文件列表|选择需要解析的Excel文件列表，可以是上一节点传入的文件集合|必填|无|
|文件|单个电子表格文件对象，与文件列表二选一|条件必填|无|
|文件名称|电子表格的文件名，通常与文件链接配合使用|条件必填|无|
|文件链接|电子表格的下载链接或访问路径|条件必填|无|

### 输出参数
电子表格解析节点输出一个结构化的表格文件对象，包含以下信息：
|输出内容|说明|
|---|---|
|表格文件 (files_spreadsheet)|电子表格的文件|
|文件名称（file_name）|文件名称|
|文件地址 (file_url)|电子表格的访问地址|
|文件扩展名 (file_extension)|文件格式扩展名，如xlsx、xls等|
|工作表 (sheet)|包含电子表格中的工作表数据|
|工作表名称 (sheet_name)|工作表的名称|
|行 (rows)|工作表中的行数据集合|
|行索引 (row_index)|行的序号，从0开始|
|单元格 (cells)|行中的单元格数据集合|
|值 (value)|单元格的实际值|
|列索引 (column_index)|单元格所在的列序号|

## 使用说明
### 基本配置步骤
1. **添加节点**：从节点面板中拖拽"电子表格解析"节点到工作流画布上
2. **连接前置节点**：将前置节点（如"开始节点"或"文件上传节点"等）的输出连接到电子表格解析节点
3. **设置输入参数**：
    1. 如果前置节点提供了文件列表，选择"文件列表"参数并引用对应变量
    2. 如果需要解析指定文件，填写"文件名称"和"文件链接"参数
4. **保存配置**：点击保存按钮确认节点设置
5. **连接后续节点**：将电子表格解析节点的输出连接到下游节点（如"大模型调用"或"代码执行"等）
### 进阶技巧
1. **批量处理多个表格**：
    1. 配置循环节点，遍历文件列表中的每个电子表格
    2. 在循环内部使用电子表格解析节点处理单个文件
    3. 使用变量保存节点存储处理结果
2. **表格数据转换**：
    1. 配合代码执行节点，可以对解析后的表格数据进行格式转换
    2. 例如将表格数据转换为JSON格式或CSV格式
3. **智能表格理解**：
    1. 将解析后的表格数据传入大模型调用节点
    2. 使用提示词引导大模型理解表格结构和数据含义
    3. 让大模型生成表格数据的摘要或回答相关问题
## 注意事项
### 文件格式支持
- 支持的文件格式包括：`.xlsx`、`.xls`、`.csv`
- 对于其他格式的表格文件，可能需要先转换为上述格式再进行解析
- 特别复杂的Excel表格（如包含宏、图表等）可能会影响解析效果
### 数据量限制
- 对于超大型表格（如几十万行的数据），解析过程可能需要较长时间
- 建议对大型表格进行分片处理，或先筛选出所需的数据部分再进行解析
- 如遇性能问题，可以考虑使用代码执行节点进行优化处理
### 编码与语言
- 对于包含特殊字符或多语言内容的表格，请确保文件使用UTF-8编码
- 中文等非英文字符在解析后可能需要额外处理才能正确显示
## 常见问题
### 解析结果为空
**问题**：配置了电子表格解析节点，但输出结果为空或没有数据。

**解决方案**：
1. 检查输入文件是否有效，文件链接是否可访问
2. 确认Excel文件中确实包含数据，而不是空表格
3. 检查文件格式是否受支持，过老的Excel格式可能需要转换
4. 尝试先下载文件到本地，再上传到平台进行处理
### 解析数据不完整
**问题**：只解析出部分表格数据，有些内容丢失或错误。

**解决方案**：
1. 检查原始表格是否存在合并单元格，这可能影响解析效果
2. 确认表格中是否包含特殊格式（如公式、图表等），这些可能无法完全解析
3. 对于多工作表的Excel文件，确保关注的是正确的工作表
4. 尝试将Excel转换为简单格式（如CSV）后再进行解析
### 无法识别日期格式
**问题**：表格中的日期解析后变成了数字或其他格式。

**解决方案**：
1. 在Excel中将日期列格式明确设置为日期格式
2. 解析后使用代码执行节点转换日期格式
3. 使用大模型调用节点识别和转换日期格式