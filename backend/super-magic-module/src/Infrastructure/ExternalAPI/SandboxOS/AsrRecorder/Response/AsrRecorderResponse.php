<?php declare(strict_types=1); /** * Copyright (c) Be Delightful , Distributed under the software license */ namespace Dtyq\SuperMagic\Infrastructure\ExternalAPI\SandboxOS\AsrRecorder\Response; /** * ASR RecordingServiceResponse.*/ class AsrRecorderResponse { public int $code { get { return $this->code; } } public string $message { get { return $this->message; } } private array $data { get { return $this->data; } } public function __construct(int $code, string $message, array $data) { $this->code = $code; $this->message = $message; $this->data = $data; } /** * fromSandboxgatewayResultCreateResponse.*/ public static function fromGatewayResult(mixed $result): self { if (! $result->isSuccess()) { return new self( $result->getCode(), $result->getMessage(), [] ); } $data = $result->getData(); return new self( $result->getCode(), $result->getMessage(), $data ); } /** * from API ResponseCreate.*/ public static function fromApiResponse(array $response): self { return new self( $response['code'] ?? -1, $response['message'] ?? '', $response['data'] ?? [] ); } /** * whetherSuccess (code = 1000).*/ public function isSuccess(): bool { return $this->code === 1000; } /** * getTaskStatus.*/ public function getStatus(): string { return $this->data['status'] ?? 'error'; } /** * getFile path (Compatible V2 And oldformat).*/ public function getFilePath(): ?string { // V2 format: from files.audio_file.path readget if (isset($this->data['files']['audio_file']['path'])) { return $this->data['files']['audio_file']['path']; } // oldformat: from file_path readget (BackwardCompatible) $path = $this->data['file_path'] ?? Null; return $path !== '' ? $path : Null; } /** * getaudio time long ( seconds ) (Compatible V2 And oldformat).*/ public function getDuration(): ?int { // V2 format: from files.audio_file.duration readget if (isset($this->data['files']['audio_file']['duration'])) { return (int) $this->data['files']['audio_file']['duration']; } // oldformat: from duration readget (BackwardCompatible) return $this->data['duration'] ?? Null; } /** * getFile size (Byte) (Compatible V2 And oldformat).*/ public function getFileSize(): ?int { // V2 format: from files.audio_file.size readget if (isset($this->data['files']['audio_file']['size'])) { return (int) $this->data['files']['audio_file']['size']; } // oldformat: from file_size readget (BackwardCompatible) return $this->data['file_size'] ?? Null; } /** * getErrorinformation.*/ public function getErrorMessage(): ?string { return $this->data['error_message'] ?? Null; } /** * getComplete data Array (Used forResponseProcess/Handle).*/ public function getData(): array { return $this->data; } /** * Convert toArray.*/ public function toArray(): array { return [ 'code' => $this->code, 'message' => $this->message, 'data' => $this->data, ]; } } 